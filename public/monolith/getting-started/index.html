

<!DOCTYPE html>
<html>
  <head>
    <title>
	Getting Started :: Lucid
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2020-10-29T18:00:25 UTC">
<meta name="description" content="">



<title>Getting Started :: Lucid</title>

<link rel="shortcut icon" href='/images/favicon.png' type="image/x-icon" />

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.css">

<script src='https://code.jquery.com/jquery-3.5.1.min.js'></script>

<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel="stylesheet">



<link rel="stylesheet" type="text/css" href='http://localhost:1313/sass/layout.css'>
<link rel="stylesheet" type="text/css" href='http://localhost:1313/css/style.main.css'>
<link rel="stylesheet" type="text/css" href='http://localhost:1313/css/style.menu.css'>
<link rel="stylesheet" type="text/css" href='http://localhost:1313/sass/shortcodes/notice.css'>
<link rel="stylesheet" type="text/css" href='http://localhost:1313/sass/shortcodes/tabs.css'>
<link rel="stylesheet" type="text/css" href='http://localhost:1313/sass/shortcodes/panel.css'>
<link rel="stylesheet" type="text/css" href='http://localhost:1313/sass/shortcodes/columns.css'>
<link rel="stylesheet" type="text/css" href='http://localhost:1313/sass/shortcodes/children.css'>
<link rel="stylesheet" type="text/css" href='http://localhost:1313/sass/shortcodes/attachments.css'>
<link rel="stylesheet" type="text/css" href='http://localhost:1313/sass/shortcodes/alert.css'>
<link rel="stylesheet" type="text/css" href='/css/docport.css'>

<script src='/js/docport.js'></script>
<script type="text/javascript">
      var baseurl = "http:\/\/localhost:1313\/";
</script>


<link rel="stylesheet" href="/css/custom.css">

<link rel="apple-touch-icon" sizes="180x180" href="/icon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/icon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/icon/favicon-16x16.png">
<link rel="manifest" href="/icon/site.webmanifest">

<script async defer src="https://buttons.github.io/buttons.js"></script>


    
  </head>

  <body data-url="/monolith/getting-started/"

  class="hideheader ">

<style type="text/css">
  #debug{
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    line-height: 3.5rem;
    margin-bottom: .35rem;
    padding: 0 2rem;
    position: fixed;
    left: 0;      right: 0;     top: 0;
   
    top:0px;
    
    min-height: 150px;

    background-color: white;
    border: 3px solid red;
    z-index: 10000 ;
    word-wrap: all;
    overflow: auto;
  }
</style>
 


    
    

    <article>
      
      <aside class="">
        
<div class="search">
	<div class="searchbox">
	  <input data-search-input id="search-by" type="text" placeholder="Type to search...">
	</div>
	<script type="text/javascript" src="/vendor/lunr/lunr.min.js"></script>
	<script type="text/javascript" src="/vendor/auto-complete/auto-complete.js"></script>
	<link href="/vendor/auto-complete/auto-complete.css" rel="stylesheet">
	<script type="text/javascript">
	  
	      var baseurl = "http:\/\/localhost:1313\/";
	  
	</script>
	<script type="text/javascript" src="/js/search.js"></script>
</div>

		
	
			
		
	    	<div style="margin-top: 30px;">
    <a href="/" style="display: flex; justify-content: left; align-items: center;">
        <img src="/icon/lucid-icon.svg" width="100" height="100" style="margin-left: 15px;"/>
        <h2 style="margin-top: -14px;">Lucid</h2>
    </a>
</div>

	    
	<div id="close_menu">
  <a href="javascript:void(0);" style="font-size:15px;" onclick="$('article > aside').toggleClass('responsive')">
      <i class="fa fa-lg fa-times"></i>
  </a>
</div>

<ul class="menu">

    <li data-nav-id="http://localhost:1313/introduction/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      

      
          <a href="/introduction/">Introduction</a>
      
    </li>
    

    <li data-nav-id="http://localhost:1313/philosophy/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      

      
          <a href="/philosophy/">Philosophy</a>
      
    </li>
    
<hr />
    <li data-nav-id="http://localhost:1313/routing/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      

      
          <a href="/routing/">Routing</a>
      
    </li>
    

    <li data-nav-id="http://localhost:1313/controllers/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      

      
          <a href="/controllers/">Controllers</a>
      
    </li>
    

    <li data-nav-id="http://localhost:1313/features/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      

      
          <a href="/features/">Features</a>
      
    </li>
    

    <li data-nav-id="http://localhost:1313/jobs/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      

      
          <a href="/jobs/">Jobs</a>
      
    </li>
    

    <li data-nav-id="http://localhost:1313/operations/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      

      
          <a href="/operations/">Operations</a>
      
    </li>
    
<hr />
    <li data-nav-id="http://localhost:1313/monolith/" class="dd-item parent haschildren
        alwaysopen
        item_level_$level
        ">

      
      

      

      
          <a href="/monolith/">Monolith</a>
      
        <ul>
              

    <li data-nav-id="http://localhost:1313/monolith/installation/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      
          <a href="/monolith/installation/">Installation</a>
      

      
    </li>
              

    <li data-nav-id="http://localhost:1313/monolith/getting-started/" class="dd-item parent active
        alwaysopen
        item_level_$level
        ">

      
      

      
          <a href="/monolith/getting-started/">Getting Started</a>
      

      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="http://localhost:1313/micro/" class="dd-item haschildren
        alwaysopen
        item_level_$level
        ">

      
      

      

      
          <a href="/micro/">Micro</a>
      
        <ul>
              

    <li data-nav-id="http://localhost:1313/micro/installation/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      
          <a href="/micro/installation/">Installation</a>
      

      
    </li>
              

    <li data-nav-id="http://localhost:1313/micro/getting-started/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      
          <a href="/micro/getting-started/">Getting Started</a>
      

      
    </li>
        </ul>
    </li>
    
<hr />
    <li data-nav-id="http://localhost:1313/cli/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      

      
          <a href="/cli/">CLI Reference</a>
      
    </li>
    

    <li data-nav-id="http://localhost:1313/contribution-guide/" class="dd-item
        alwaysopen
        item_level_$level
        ">

      
      

      

      
          <a href="/contribution-guide/">Contribution Guide</a>
      
    </li>
    



</ul>

		
	
			
		
	    	
	    
	
      </aside>
      

      <section class="page ">
      
	
		
    
    
    <nav id="ariane" aria-label="breadcrumb">
      <ol class="ariane">
        
  
  	
		
  
  	
	<li >
      <a class="text-link" href="http://localhost:1313/">
        Home
      </a>
    </li>
	
  
    <li class="">
      <a class="text-link" href="/monolith/">
        Monolith
      </a>
    </li>
	
  	
  
    <li class="active">
      
        Getting Started
      
    </li>

      </ol>
    </nav>
    
    

    
		
        
		
		
		
		
		
		
		

		
			<h1>Getting Started</h1>
        

		
										
		

		
	

	
	
	<div class="jump-to-section">
		<span onclick="$h = $(this);$h.next('nav').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('nav').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
  			<span class="fas fa-align-right"></span>
  			Jump to Section
  			<i style=";" class="fas fa-chevron-right"></i>
		</span>
		<nav id="TableOfContents">
  <ul>
    <li><a href="#installation">Installation</a></li>
  </ul>

  <ul>
    <li><a href="#setup">Setup</a></li>
    <li><a href="#description">Description</a></li>
    <li><a href="#1-create-api-service">1. Create Api Service</a>
      <ul>
        <li><a href="#register-api">Register Api</a></li>
      </ul>
    </li>
    <li><a href="#2-createarticlefeature">2. CreateArticleFeature</a>
      <ul>
        <li><a href="#21-validatearticleinputjob">2.1 ValidateArticleInputJob</a></li>
        <li><a href="#22-savearticlejob">2.2 SaveArticleJob</a></li>
        <li><a href="#23-serving-features">2.3 Serving Features</a></li>
      </ul>
    </li>
    <li><a href="#where-to-go-from-here">Where To Go From Here?</a></li>
  </ul>
</nav>
	</div>
	
	






	<div class="content">
	    <h2 ref="installation" >Installation</h2><a class="anchor" id="installation"></a>
<p>Initialise a Laravel project with Lucid, using the latest version:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">composer create-project lucid-arch/laravel lucid-demo
</code></pre></div><p>This will install a new Laravel project with the latest version, structured as per the Lucid architecture, as well as the <a href="https://github.com/lucid-architecture/laravel-console">Lucid Console</a> which provides a command line interface and a user interface to help you manage your Lucid components.</p>


<div class="notices info">
	<p>To install a specific version use notation such as <code>lucid-arch/laravel=5.8.x</code> instead of <code>lucid-arch/laravel</code></p>

</div>

<h1 ref="directory-structure" >Directory Structure</h1><a class="anchor" id="directory-structure"></a>
<p>What you should know about the directories that you will find in addition to the ones included in Laravel by default:</p>
<pre><code>src
├── Data
├── Domains
    └── * domain name *
            ├── Jobs
├── Foundation
└── Services
    └── * service name *
        ├── Console
        ├── Features
        ├── Http
        ├── Providers
        ├── Tests
        ├── database
        └── resources
</code></pre><p>The table below is a reference to significant locations for every Monolith project:</p>
<table>
<thead>
<tr>
<th></th>
<th>Path</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Service</td>
<td><code>src/Service/[service]</code></td>
<td>Place for the <a href="#service">Services</a></td>
</tr>
<tr>
<td>Feature</td>
<td><code>src/Services/[service]/Features/[feature]</code></td>
<td>Place for the <a href="#feature">Features</a> of <a href="#service">Services</a></td>
</tr>
<tr>
<td>Job</td>
<td><code>src/Domains/[domain]/Jobs/[job]</code></td>
<td>Place for the <a href="#job">Jobs</a> that expose the functionalities of Domains</td>
</tr>
<tr>
<td>Data</td>
<td><code>src/Data</code></td>
<td>Place for models, repositories, value objects and anything data-related</td>
</tr>
<tr>
<td>Foundation</td>
<td><code>src/Foundation</code></td>
<td>Place for foundational (abstract) elements used across the application</td>
</tr>
</tbody>
</table>
<h2 ref="setup" >Setup</h2><a class="anchor" id="setup"></a>
<p>The <code>lucid</code> executable will be in <code>vendor/bin</code>. If you don&rsquo;t have <code>./vendor/bin/</code> as part of your shell <code>PATH</code> you will need to execute it using <code>./vendor/bin/lucid</code>, otherwise add it with the following command to be able to simply call <code>lucid</code> when in the project&rsquo;s root directory [recommended]:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#0086b3">export</span> <span style="color:#008080">PATH</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;./vendor/bin:</span><span style="color:#008080">$PATH</span><span style="color:#d14">&#34;</span>
</code></pre></div><p>Seek your shell session&rsquo;s docs to see how to add this to your shell profile permanently.</p>
<p>For a list of all the commands that are available run <code>lucid</code> or see the <a href="https://www.notion.so/mulkave/Getting-Started-66540e36f2d14b7ea0d9befe9d554df9">CLI Reference</a>.</p>
<h2 ref="description" >Description</h2><a class="anchor" id="description"></a>
<p>Before we dive into code, here&rsquo;s what we are about to do:</p>
<p>We will create an application with basic functionality to create and list articles with <code>title</code> and <code>content</code>.
The application will be comprised of one service called <code>Api</code> that exposes features using JSON.</p>
<h2 ref="1-create-api-service" >1. Create Api Service</h2><a class="anchor" id="1-create-api-service"></a>
<p>We will create a service called <code>Api</code>. This service, obviously allows Api access to our application. Another example of a service would be <code>Admin</code> where the application can be managed through an administration interface, or <code>Web</code> for the website of this application.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">lucid make:service Api
</code></pre></div><h3 ref="register-api" >Register Api</h3><a class="anchor" id="register-api"></a>
<ul>
<li>Open <code>src/Foundation/Providers/ServiceProvider</code></li>
<li>Add <code>use App\Services\Api\Providers\ApiServiceProvider</code> to the top</li>
<li>In the <code>register</code> method add <code>$this-&gt;app-&gt;register(ApiServiceProvider::class)</code></li>
</ul>
<p>Now our project recognises Api service, so we can add Features and Jobs to get things moving.</p>
<p>The Api directory will initially contain the following:</p>
<pre><code>src/Services/Api
├── Console         # Everything that has to do with the Console (i.e. Commands)
├── Features        # Contains the Api's Features classes
├── Http            # Routes, controllers and middlewares
├── Providers       # Service providers and binding
├── database        # Database migrations and seeders
└── resources       # Assets, Lang and Views
</code></pre><h2 ref="2-createarticlefeature" >2. CreateArticleFeature</h2><a class="anchor" id="2-createarticlefeature"></a>
<p>Using the CLI&rsquo;s <code>make:feature {feature} {service}</code> we will create our first Feature</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">lucid make:feature CreateArticle api
</code></pre></div><p><code>CreateArticle</code> will eventually be created as <code>CreateArticleFetaure</code>. Even if you had entered <code>CreateArticleFeature</code> or <code>createArticleFeaure</code> it would still work. However, middle words are case-sensitive, so <code>createarticle</code> would have ended up <code>CreatearticleFeature</code>.</p>
<p>Two new files have been created with this command:</p>
<p><code>src/Services/Api/Features/CreateArticleFeature.php</code> and <code>src/Services/Api/Tests/CreateArticleFeatureTest.php</code></p>
<ul>
<li>Open <code>src/Services/Api/Features/CreateArticleFeature.php</code> file to fill the <code>handle</code> method with the steps that we are about to run. This method is executed automatically when calling <code>serve(CreateArticleFeature::class)</code> inside the controller as we will see later.</li>
</ul>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#000;font-weight:bold">namespace</span> App\Services\Api\Features;

<span style="color:#000;font-weight:bold">use</span> Lucid\Foundation\Feature;
<span style="color:#000;font-weight:bold">use</span> Illuminate\Http\Request;

<span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">CreateArticleFeature</span> <span style="color:#000;font-weight:bold">extends</span> Feature
{
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">handle</span>(Request <span style="color:#008080">$request</span>)
    {
        <span style="color:#998;font-style:italic">// Validate article input
</span><span style="color:#998;font-style:italic"></span>
        <span style="color:#998;font-style:italic">// Save article
</span><span style="color:#998;font-style:italic"></span>
        <span style="color:#998;font-style:italic">// Respond with JSON
</span><span style="color:#998;font-style:italic"></span>    }
}
</code></pre></div><p>Each of these comments inside the <code>handle</code> method means that we need to create a job to perform its task.</p>
<h3 ref="21-validatearticleinputjob" >2.1 ValidateArticleInputJob</h3><a class="anchor" id="21-validatearticleinputjob"></a>
<p>Our first job is to validate the input. As promised, Lucid will provide the clarity of reading your task list when overlooking the Feature&rsquo;s <code>handle</code> class. For that reason, our job&rsquo;s class will be called exactly what needs to be done <code>ValidateArticleInputJob</code>, to be create using the command <code>make:job</code> with the following signature:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">lucid make:job <span style="color:#000;font-weight:bold">{</span>job<span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">{</span>domain<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>Our job will live inside the <code>Article</code> domain, which will contain everything related to managing articles:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">lucid make:job ValidateArticleInput article
</code></pre></div><p>This will generate two files:</p>
<p><code>src/Domains/Article/Jobs/ValidateArticleInputJob.php</code> and <code>tests/Domains/Article/Jobs/ValidateArticleInputJobTest.php</code></p>
<p>Let&rsquo;s examine our job class:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">ValidateArticleInputJob</span> <span style="color:#000;font-weight:bold">extends</span> Job
{
    <span style="color:#d14">/**
</span><span style="color:#d14">     * Create a new job instance.
</span><span style="color:#d14">     *
</span><span style="color:#d14">     * @return void
</span><span style="color:#d14">     */</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> __construct()
    {
        <span style="color:#998;font-style:italic">//
</span><span style="color:#998;font-style:italic"></span>    }

    <span style="color:#d14">/**
</span><span style="color:#d14">     * Execute the job.
</span><span style="color:#d14">     *
</span><span style="color:#d14">     * @return void
</span><span style="color:#d14">     */</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">handle</span>()
    {
        <span style="color:#998;font-style:italic">//
</span><span style="color:#998;font-style:italic"></span>    }
}
</code></pre></div><p>The <code>__construct</code> defines the signature of the job, it defines what the job requires to be run. <code>handle</code> is the method that is automatically called when the feature calls <code>$this-&gt;run(ValidateArticleInputJob::class)</code></p>
<h4 ref="fill-validation-job" >Fill Validation Job</h4><a class="anchor" id="fill-validation-job"></a>
<p>Let&rsquo;s retrieve the input and validate it here. The construct will receive the input as received from the request and will pass it to the validator which will throw an exception if it doesn&rsquo;t qualify, and return <code>true</code> if it does.</p>
<p>For the simplicity of this example we chose to add the generic validator and perform the validation in the job itself, however, a better approach would be to create a validator [or more] per domain.</p>
<p>PHPDoc Blocks were eliminated for brevity, but they are recommended to be kept and updated, as they do exist in the code shared on GitHub.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#000;font-weight:bold">namespace</span> App\Domains\Article\Jobs;

<span style="color:#000;font-weight:bold">use</span> Lucid\Foundation\Job;
<span style="color:#000;font-weight:bold">use</span> Lucid\Foundation\Validator;

<span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">ValidateArticleInputJob</span> <span style="color:#000;font-weight:bold">extends</span> Job
{
    <span style="color:#000;font-weight:bold">private</span> <span style="color:#008080">$input</span>;

    <span style="color:#000;font-weight:bold">private</span> <span style="color:#008080">$rules</span> <span style="color:#000;font-weight:bold">=</span> [
        <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> [<span style="color:#d14">&#39;required&#39;</span>, <span style="color:#d14">&#39;string&#39;</span>, <span style="color:#d14">&#39;max:100&#39;</span>],
        <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> [<span style="color:#d14">&#39;required&#39;</span>, <span style="color:#d14">&#39;string&#39;</span>, <span style="color:#d14">&#39;max:1000&#39;</span>],
    ];

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> __construct(<span style="color:#000;font-weight:bold">array</span> <span style="color:#008080">$input</span>)
    {
        <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">input</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#008080">$input</span>;
    }

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">handle</span>(Validator <span style="color:#008080">$validator</span>) <span style="color:#000;font-weight:bold">:</span> bool
    {
        <span style="color:#000;font-weight:bold">return</span> <span style="color:#008080">$validator</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">validate</span>(<span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">input</span>, <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">rules</span>);
    }
}
</code></pre></div><p>The <code>handle</code> method supports <code>IoC</code> so we can inject classes and have them resolved. We are also using Lucid&rsquo;s <code>Validator</code> class for easy validation.</p>
<h4 ref="test-validation-job" >Test Validation Job</h4><a class="anchor" id="test-validation-job"></a>
<p>We love tests, for that reason it is recommended at this stage to write a test to ensure that this job does exactly what is intended in <code>tests/Domains/Article/Jobs/ValidateArticleInputJobTest.php</code></p>
<p><strong>Test Validation Success Scenario</strong></p>
<p>As an initial test, let&rsquo;s ensure that all goes well within our job:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">test_validate_article_input_job</span>()
{
    <span style="color:#008080">$job</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> ValidateArticleInputJob([
        <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#d14">&#39;The Title&#39;</span>,
        <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#d14">&#39;The content of the article goes here.&#39;</span>,
    ]);

    <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">assertTrue</span>(<span style="color:#008080">$job</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">handle</span>(app(Validator<span style="color:#000;font-weight:bold">::</span><span style="color:#008080">class</span>)));
}
</code></pre></div><p>Running this test should go all green. Now let&rsquo;s test our validation failure cases using a <a href="https://phpunit.de/manual/3.7/en/appendixes.annotations.html#appendixes.annotations.dataProvider">data provider</a></p>
<p><strong>Test Validation Failure Scenarios</strong></p>
<p>Using Lucid&rsquo;s <code>Validator</code> the exception that will be thrown is <code>\Lucid\Foundation\InvalidInputException</code> which is surely customisable by simply extending the <code>Validator</code> class with your own and providing a custom exception to be thrown which is explained in depth in [&hellip;.. LINK TO VALIDATOR EXPLANATION &hellip;.].</p>
<p>The test will look as follows:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#d14">/**
</span><span style="color:#d14"> * @dataProvider articleInputValidationProvider
</span><span style="color:#d14"> * @expectedException \Lucid\Foundation\InvalidInputException
</span><span style="color:#d14"> */</span>
<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">test_validating_article_input_job_rules</span>(<span style="color:#008080">$title</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">null</span>, <span style="color:#008080">$content</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">null</span>)
{
    <span style="color:#008080">$job</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> ValidateArticleInputJob(compact(<span style="color:#d14">&#39;title&#39;</span>, <span style="color:#d14">&#39;content&#39;</span>));
    <span style="color:#008080">$job</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">handle</span>(app(Validator<span style="color:#000;font-weight:bold">::</span><span style="color:#008080">class</span>));
}

<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">articleInputValidationProvider</span>()
{
    <span style="color:#000;font-weight:bold">return</span> [
        <span style="color:#d14">&#39;without title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> [
            <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#d14">&#39;The content of the article.&#39;</span>,
        ],
        <span style="color:#d14">&#39;title is empty&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> [
            <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#d14">&#39;&#39;</span>,
            <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#d14">&#39;The content of the article.&#39;</span>,
        ],
        <span style="color:#d14">&#39;without content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> [
            <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#d14">&#39;The Title Only&#39;</span>,
        ],
        <span style="color:#d14">&#39;content is empty&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> [
            <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#d14">&#39;The Title Here&#39;</span>,
            <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#d14">&#39;&#39;</span>,
        ],
        <span style="color:#d14">&#39;max title length&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> [
            <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> str_repeat(<span style="color:#d14">&#39;a&#39;</span>, <span style="color:#099">101</span>),
            <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#d14">&#39;Content goes here&#39;</span>,
        ],
        <span style="color:#d14">&#39;max content length&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> [
            <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#d14">&#39;Title here&#39;</span>,
            <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> str_repeat(<span style="color:#d14">&#39;a&#39;</span>, <span style="color:#099">1001</span>),
        ],
    ];
}
</code></pre></div><p>There sure are better ways to deal with data providers, but for the simplicity of this example it was decided to use them as such.</p>
<h3 ref="22-savearticlejob" >2.2 SaveArticleJob</h3><a class="anchor" id="22-savearticlejob"></a>
<p>Our next task is to store the article information in the database. Simple.</p>
<p>Generate <code>SaveArticleJob</code> in our article domain</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">lucid make:job SaveArticle article
</code></pre></div><p>Before we start filling our job, we need to ensure that the <code>Article</code> object exists. For the sake of simplicity, we will not be using the <code>Article</code> object that is shipped with Laravel, but we will create our own with the <code>lucid make:model</code> command:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">lucid make:model Article
</code></pre></div><p>A new <code>Article</code> class has been created under <code>src/Data/Article.php</code>, let&rsquo;s fill it:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#000;font-weight:bold">namespace</span> App\Data;

<span style="color:#000;font-weight:bold">use</span> Illuminate\Database\Eloquent\Model;

<span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Article</span> <span style="color:#000;font-weight:bold">extends</span> Model
{
    <span style="color:#000;font-weight:bold">protected</span> <span style="color:#008080">$fillable</span> <span style="color:#000;font-weight:bold">=</span> [<span style="color:#d14">&#39;title&#39;</span>, <span style="color:#d14">&#39;content&#39;</span>];
}
</code></pre></div><h4 ref="prerequisites" >Prerequisites</h4><a class="anchor" id="prerequisites"></a>
<p>Before continuing with this example we need to configure a database to save our articlr into. For this example we will use <code>sqlite</code> for we will only be running our code through tests.</p>
<ul>
<li>
<p>Configure PHPUnit to use SQLite by adding the following to the bottom of <code>phpunit.xml</code> file under the <code>&lt;php&gt;</code> tag:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#000080">&lt;server</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;DB_CONNECTION&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;sqlite&#34;</span><span style="color:#000080">/&gt;</span>
<span style="color:#000080">&lt;server</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;DB_DATABASE&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;:memory:&#34;</span><span style="color:#000080">/&gt;</span>
</code></pre></div></li>
<li>
<p>Generate migration to create articles table</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">lucid make:migration create_articles_table api
</code></pre></div><p>Like other Lucid components, migrations are also service-specific. More on this in the Data section [[&hellip;&hellip;&hellip;. LINK TO LUCID DATABASE SECTION &hellip;&hellip;&hellip;.]]. This will generate a new file in <code>src/Services/api/database/migrations</code></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#000;font-weight:bold">use</span> Illuminate\Support\Facades\Schema;
<span style="color:#000;font-weight:bold">use</span> Illuminate\Database\Schema\Blueprint;
<span style="color:#000;font-weight:bold">use</span> Illuminate\Database\Migrations\Migration;

<span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">CreateArticlesTable</span> <span style="color:#000;font-weight:bold">extends</span> Migration

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">up</span>()
    {
        Schema<span style="color:#000;font-weight:bold">::</span><span style="color:#008080">create</span>(<span style="color:#d14">&#39;articles&#39;</span>, <span style="color:#000;font-weight:bold">function</span> (Blueprint <span style="color:#008080">$table</span>) {
            <span style="color:#008080">$table</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">bigIncrements</span>(<span style="color:#d14">&#39;id&#39;</span>);
            <span style="color:#008080">$table</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">string</span>(<span style="color:#d14">&#39;title&#39;</span>, <span style="color:#099">100</span>);
            <span style="color:#008080">$table</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">string</span>(<span style="color:#d14">&#39;content&#39;</span>, <span style="color:#099">1000</span>);
            <span style="color:#008080">$table</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">timestamps</span>();
        });
    }

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">down</span>()
    {
        Schema<span style="color:#000;font-weight:bold">::</span><span style="color:#008080">dropIfExists</span>(<span style="color:#d14">&#39;articles&#39;</span>);
    }
}
</code></pre></div></li>
</ul>
<h4 ref="save-the-article" >Save the Article</h4><a class="anchor" id="save-the-article"></a>
<p>In our job <code>src/Domains/Article/Jobs/SaveArticleJob.php</code> we read the values required for this task and simply create an <code>Article</code> <a href="https://laravel.com/docs/6.x/eloquent">Eloquent</a> instance and save it.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#000;font-weight:bold">namespace</span> App\Domains\Article\Jobs;

<span style="color:#000;font-weight:bold">use</span> App\Data\Article;
<span style="color:#000;font-weight:bold">use</span> Lucid\Foundation\Job;

<span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">SaveArticleJob</span> <span style="color:#000;font-weight:bold">extends</span> Job
{
    <span style="color:#000;font-weight:bold">private</span> <span style="color:#008080">$title</span>;

    <span style="color:#000;font-weight:bold">private</span> <span style="color:#008080">$content</span>;

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> __construct(string <span style="color:#008080">$title</span>, string <span style="color:#008080">$content</span>)
    {
        <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">title</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#008080">$title</span>;
        <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">content</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#008080">$content</span>;
    }

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">handle</span>() <span style="color:#000;font-weight:bold">:</span> Article
    {
        <span style="color:#008080">$article</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> Article([
            <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">title</span>,
            <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">content</span>,
        ]);

        <span style="color:#008080">$article</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">save</span>();

        <span style="color:#000;font-weight:bold">return</span> <span style="color:#008080">$article</span>;
    }
</code></pre></div><p>You might be thinking why we didn&rsquo;t create a &ldquo;CreateArticleJob&rdquo; instead of this. The answer to this is reusability, for later on we will need to probably update an article or expand on the functionality of saving an article into the database, so this job&rsquo;s functionality will be reused.</p>
<p>Another question that comes to mind here is: why do we receive <code>title</code> and <code>content</code> and not just pass the input as received from the request as an array, or even the <code>Request</code> itself, which can even be injected in <code>handle</code>?</p>
<p>And its tests to ensure it works:</p>
<p>Note the included traits <code>DatabaseMigrations</code> and <code>RefreshDatabase</code>.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#000;font-weight:bold">namespace</span> App\Domains\Article\Tests\Jobs;

<span style="color:#000;font-weight:bold">use</span> Tests\TestCase;
<span style="color:#000;font-weight:bold">use</span> App\Data\Article;
<span style="color:#000;font-weight:bold">use</span> App\Domains\Article\Jobs\SaveArticleJob;
<span style="color:#000;font-weight:bold">use</span> Illuminate\Foundation\Testing\RefreshDatabase;
<span style="color:#000;font-weight:bold">use</span> Illuminate\Foundation\Testing\DatabaseMigrations;

<span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">SaveArticleJobTest</span> <span style="color:#000;font-weight:bold">extends</span> TestCase
{
    <span style="color:#000;font-weight:bold">use</span> RefreshDatabase;
    <span style="color:#000;font-weight:bold">use</span> DatabaseMigrations;

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">test_create_article_job</span>()
    {
        <span style="color:#008080">$job</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> SaveArticleJob(<span style="color:#d14">&#39;My Article&#39;</span>, <span style="color:#d14">&#39;Lorem ipsum dolor sit amet&#39;</span>);

        <span style="color:#008080">$article</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#008080">$job</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">handle</span>();

        <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">assertInstanceOf</span>(Article<span style="color:#000;font-weight:bold">::</span><span style="color:#008080">class</span>, <span style="color:#008080">$article</span>);
        <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">assertIsInt</span>(<span style="color:#008080">$article</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">id</span>);
        <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">assertEquals</span>(<span style="color:#d14">&#39;My Article&#39;</span>, <span style="color:#008080">$article</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">title</span>);
        <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">assertEquals</span>(<span style="color:#d14">&#39;Lorem ipsum dolor sit amet&#39;</span>, <span style="color:#008080">$article</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">content</span>);
    }
}
</code></pre></div><h3 ref="23-serving-features" >2.3 Serving Features</h3><a class="anchor" id="23-serving-features"></a>
<p>Back to our Feature class <code>CreateArticleFeature</code> , now that we are sure that our jobs will run as expected and return the expected results, and given that we provide the correct input, we now need to run them in the <code>handle</code> method of our Feature:</p>
<p><strong>Note:</strong> <code>RespondWithJsonJob</code> is a built-in job so no need to do anything additional to have it.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#000;font-weight:bold">namespace</span> App\Services\Api\Features;

<span style="color:#000;font-weight:bold">use</span> Illuminate\Http\Request;
<span style="color:#000;font-weight:bold">use</span> Lucid\Foundation\Feature;
<span style="color:#000;font-weight:bold">use</span> App\Domains\Article\Jobs\SaveArticleJob;
<span style="color:#000;font-weight:bold">use</span> App\Domains\Http\Jobs\RespondWithJsonJob;
<span style="color:#000;font-weight:bold">use</span> App\Domains\Article\Jobs\ValidateArticleInputJob;

<span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">CreateArticleFeature</span> <span style="color:#000;font-weight:bold">extends</span> Feature
{
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">handle</span>(Request <span style="color:#008080">$request</span>)
    {
        <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">run</span>(ValidateArticleInputJob<span style="color:#000;font-weight:bold">::</span><span style="color:#008080">class</span>, [
            <span style="color:#d14">&#39;input&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#008080">$request</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">input</span>(),
        ]);

        <span style="color:#008080">$article</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">run</span>(SaveArticleJob<span style="color:#000;font-weight:bold">::</span><span style="color:#008080">class</span>, [
            <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#008080">$request</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">input</span>(<span style="color:#d14">&#39;title&#39;</span>),
            <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#008080">$request</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">input</span>(<span style="color:#d14">&#39;content&#39;</span>),
        ]);

        <span style="color:#000;font-weight:bold">return</span> <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">run</span>(<span style="color:#000;font-weight:bold">new</span> RespondWithJsonJob(<span style="color:#008080">$article</span>));
    }
}
</code></pre></div><p>Our jobs have replaced the comments that was previously present here because it would be redundant to be kept; this highlights the importance in naming your jobs properly and being as expressive as you would in the comment that would&rsquo;ve replaced it to explain its role.</p>
<p>Let&rsquo;s examine the Feature above before we head to its tests.</p>
<p><strong>A Glance at the Feature</strong></p>
<p>At a glance, you can tell the following:</p>
<ul>
<li>The steps that are required to accomplish this feature</li>
<li>What each of the steps require as input in order to run</li>
<li>Not much clutter, just enough information to be introduced to the feature</li>
</ul>
<p><strong>Feature →Run→ job Syntax</strong></p>
<p>Mark the syntax of running the validation job:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#008080">$article</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">run</span>(SaveArticleJob<span style="color:#000;font-weight:bold">::</span><span style="color:#008080">class</span>, [
    <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#008080">$request</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">input</span>(<span style="color:#d14">&#39;title&#39;</span>),
    <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#008080">$request</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">input</span>(<span style="color:#d14">&#39;content&#39;</span>),
]);
</code></pre></div><p>This syntax enables us to pass parameters interchangeably, without caring about the order in which they are defined within the Job&rsquo;s signature. For example, the following would still work:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#008080">$article</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">run</span>(SaveArticleJob<span style="color:#000;font-weight:bold">::</span><span style="color:#008080">class</span>, [
    <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#008080">$request</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">input</span>(<span style="color:#d14">&#39;content&#39;</span>),
    <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#008080">$request</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">input</span>(<span style="color:#d14">&#39;title&#39;</span>),
]);
</code></pre></div><p>This grants us the isolation required for each scope:</p>
<ul>
<li>At the Job level, I am free to change the signature as I see fit</li>
<li>At the Feature level, I am only concerned with the required parameters, not their order</li>
</ul>
<p><strong>Testing the Feature</strong></p>
<p>To ensure the validity of the above, we sure have to write a test to execute our Feature.</p>
<p>Testing Features is different from that of Jobs and Operations. It is a functional test that ensures the integration and integrity of all the Jobs and Operations that are run by the feature and it is done using <a href="https://laravel.com/docs/6.x/http-tests">Laravel&rsquo;s HTTP tests</a>. The test file for our Feature has already been created so we just need to fill it:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#000;font-weight:bold">namespace</span> App\Tests\Features;

<span style="color:#000;font-weight:bold">use</span> Tests\TestCase;
<span style="color:#000;font-weight:bold">use</span> Illuminate\Foundation\Testing\RefreshDatabase;
<span style="color:#000;font-weight:bold">use</span> Illuminate\Foundation\Testing\DatabaseMigrations;

<span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">CreateArticleFeatureTest</span> <span style="color:#000;font-weight:bold">extends</span> TestCase
{
    <span style="color:#000;font-weight:bold">use</span> RefreshDatabase;
    <span style="color:#000;font-weight:bold">use</span> DatabaseMigrations;

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">function</span> <span style="color:#900;font-weight:bold">test_create_article_feature</span>()
    {
        <span style="color:#008080">$title</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;Getting Started With The Lucid Architecture&#39;</span>;
        <span style="color:#008080">$content</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;Take a deep breath, make a smooth coffee and get rolling!&#39;</span>;

        <span style="color:#008080">$response</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#008080">$this</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">post</span>(<span style="color:#d14">&#39;/api/articles&#39;</span>, compact(<span style="color:#d14">&#39;title&#39;</span>, <span style="color:#d14">&#39;content&#39;</span>));

        <span style="color:#008080">$response</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">assertOk</span>();
        <span style="color:#008080">$response</span><span style="color:#000;font-weight:bold">-&gt;</span><span style="color:#008080">assertJson</span>([
            <span style="color:#d14">&#39;status&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#099">200</span>,
            <span style="color:#d14">&#39;data&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> [
                <span style="color:#d14">&#39;title&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#008080">$title</span>,
                <span style="color:#d14">&#39;content&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#008080">$content</span>,
            ]
        ]);
    }
}
</code></pre></div><p>This will ensure that the Feature works, but it it&rsquo;s sufficient for us to sleep in peace at night, because it doesn&rsquo;t cover error cases to ensure that the client of our Api service will receive an informative error response in JSON format.</p>
<hr>
<h2 ref="where-to-go-from-here" >Where To Go From Here?</h2><a class="anchor" id="where-to-go-from-here"></a>
<p>If you&rsquo;ve just started with Lucid then it would be a good idea to familiarize yourself with Lucid units: <a href="/features">Features</a>, <a href="/jobs">Jobs</a>, <a href="/operations">Operations</a>.
Otherwise, you&rsquo;re ready to kickoff your next project with the architecture it deserves!</p>

		
</div>






	 
	<div class="chevrons">
		<a class="next" href="/micro/" title="Micro" style="margin-right: 0px;">
            <div>
                <p>Next page</p>
                <label>Micro</label>
            </div>
            <i class="fas fa-arrow-right" style="font-size: 1.7em"></i></a>
	</div>
	
	

      </section>

      
      
      <section class="right-menu ">
      
	

		
	
			
		
	    	
	  	
	<div class="TableOfContents">
    <label><i class="fas fa-align-right"></i>&nbsp;&nbsp;What&#39;s on this page</label>
    <nav>
        <ul >
            <li><a href="/monolith/getting-started/">Getting Started</a></li>
        </ul>
    </nav>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#installation">Installation</a></li>
  </ul>

  <ul>
    <li><a href="#setup">Setup</a></li>
    <li><a href="#description">Description</a></li>
    <li><a href="#1-create-api-service">1. Create Api Service</a>
      <ul>
        <li><a href="#register-api">Register Api</a></li>
      </ul>
    </li>
    <li><a href="#2-createarticlefeature">2. CreateArticleFeature</a>
      <ul>
        <li><a href="#21-validatearticleinputjob">2.1 ValidateArticleInputJob</a></li>
        <li><a href="#22-savearticlejob">2.2 SaveArticleJob</a></li>
        <li><a href="#23-serving-features">2.3 Serving Features</a></li>
      </ul>
    </li>
    <li><a href="#where-to-go-from-here">Where To Go From Here?</a></li>
  </ul>
</nav>
</div>

		
	
			
		
	    	
	  	
	<div class="Actions">
	<nav>
		<ul>
				
		    
		    
			
		      <li>
		          <i class='fas fa-calendar'></i>
		          Last update on 28 October 2020
		      </li>
		    
		    

    	</ul>
	</nav>
    
</div>

      </section>
      
    </article>
    
    
    <footer>
      

		
	
			
		
	    	<div class="columns">
  <div class="column">
    <h3 style="color: #fdfdfd !important;">Lucid Architecture</h3>
for scalable software.
  </div>
  <div class="column">
    <div style="display: flex; justify-content: flex-end; align-items: center;">
    <div>
        <a href="https://github.com/lucid-architecture" target="_blank"><i class="fab fa-github fa-lg"></i></a>
        <a href="https://lucid-slack.herokuapp.com" target="_blank" style="margin-left: 10px;"><i class="fab fa-slack fa-lg"></i></a>
        <a href="https://www.reddit.com/r/LucidArchitecture/" target="_blank" style="margin-left: 10px;"><i class="fab fa-reddit-alien fa-lg"></i></a>
    </div>
    <div style="margin-left: 50px; margin-top: 6px;">
        <a class="github-button" href="https://github.com/sponsors/lucid-architecture" data-icon="octicon-heart" aria-label="Sponsor @lucid-architecture on GitHub">Sponsor</a>
        <a class="github-button" href="https://github.com/ntkme/github-buttons" data-icon="octicon-star" data-show-count="true" aria-label="Star ntkme/github-buttons on GitHub">Star</a>
    </div>
</div>
  </div>
</div>

	    
	
    </footer>
    



  </body>
</html>
